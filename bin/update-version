#!/usr/bin/env php
<?php

$files = [
  "plugin.php" => [
    "/@version $vReg/" => "@version $version",
    "/Version: $vReg/" => "Version: $version",
  ],

  "config/app.php" => [
    "/'version' => '$vReg'/" => "'version' => '$version'"
  ],
];

$version = trim(`git describe --abbrev=0 --tags`);
$vReg = "\d{1,2}\.\d{1,2}\.\d{1,3}";

foreach ($files as $file => $selection) {
  $contents = file_get_contents($file);

  foreach ($selection as $old => $new) {
    $contents = preg_replace($old, $new, $contents);
  }

  file_put_contents($file, $contents);
}
